---
title: 概述 - 网格计算风险分析 - Azure Batch、Azure Data Lake
author: dstarr
ms.author: dastarr
ms.date: 11/20/2019
ms.topic: article
ms.service: industry
description: 介绍了为银行业务风险网格计算实施 Azure Batch 的技术方面。
ms.openlocfilehash: 542fb820870048ac2ec2cb67c2bbf13988588ea1
ms.sourcegitcommit: 3b175d73a82160c4cacec1ce00c6d804a93c765d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/06/2020
ms.locfileid: "77053175"
---
# <a name="risk-grid-computing-in-banking-solution-guide"></a><span data-ttu-id="f7a11-103">银行业务风险网格计算解决方案指南</span><span class="sxs-lookup"><span data-stu-id="f7a11-103">Risk Grid Computing in Banking Solution Guide</span></span>

<span data-ttu-id="f7a11-104">本文提供了使用 Microsoft Azure 支持和增强银行业务风险网格计算的技术概述，包括建议的系统和高级体系结构。</span><span class="sxs-lookup"><span data-stu-id="f7a11-104">This article provides a technical overview of using Microsoft Azure to support and enhance risk grid computing in banking, including recommended systems and high-level architectures.</span></span>

<span data-ttu-id="f7a11-105">本文档适用于解决方案架构师，在某些情况下还适用于想要深入了解建议用于风险计算的解决方案的技术决策者。</span><span class="sxs-lookup"><span data-stu-id="f7a11-105">This document is intended for Solution Architects, and in some cases Technical Decision Makers, who want a deep dive on proposed solutions for risk computing.</span></span>

## <a name="introduction"></a><span data-ttu-id="f7a11-106">介绍</span><span class="sxs-lookup"><span data-stu-id="f7a11-106">Introduction</span></span>

<span data-ttu-id="f7a11-107">财务风险分析模型通常作为批处理作业得以处理，其中繁重的计算负载对计算能力、数据访问和分析能力提出了很高的要求。</span><span class="sxs-lookup"><span data-stu-id="f7a11-107">Financial risk analysis models are typically processed as batch jobs, with heavy compute loads generating high demand for computing power, data access, and analysis.</span></span> <span data-ttu-id="f7a11-108">对风险网格计算的需求通常随时间推移而增长，计算资源的需求也会相应地增长。</span><span class="sxs-lookup"><span data-stu-id="f7a11-108">Demand for risk grid computing calculations often grows over time, and correspondingly the need for compute resources increases.</span></span>

<span data-ttu-id="f7a11-109">Azure 中广泛的产品和服务意味着大多数问题可以有多个解决方案。</span><span class="sxs-lookup"><span data-stu-id="f7a11-109">The broad range of available products and services in Azure means there can be more than one solution to most problems.</span></span> <span data-ttu-id="f7a11-110">本文概述了使用 [Microsoft Azure Batch](/azure/batch/batch-dotnet-get-started?WT.mc_id=gridbanksg-docs-dastarr) 判定最适用于银行业务风险网格计算解决方案的技术、模式和实践。</span><span class="sxs-lookup"><span data-stu-id="f7a11-110">This article provides an overview of the technologies, patterns and practices gauged to be most effective for a risk grid computing solution in banking using [Microsoft Azure Batch](/azure/batch/batch-dotnet-get-started?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

<span data-ttu-id="f7a11-111">Azure Batch 是一项免费服务，可为通常用于风险网格计算模型的基础结构和各个批处理阶段提供经济高效且安全的解决方案。</span><span class="sxs-lookup"><span data-stu-id="f7a11-111">Azure Batch is a free service providing cost-effective and secure solutions for both the infrastructure and the various stages of batch processing typically used with risk grid computing models.</span></span> <span data-ttu-id="f7a11-112">Azure Batch 可以使用混合网络或通过将整个批处理过程移动到 Azure 中来增强、扩展甚至替换当前的本地计算资源投资。</span><span class="sxs-lookup"><span data-stu-id="f7a11-112">Azure Batch can augment, extend, or even replace current on-premises compute resource investments using hybrid networks or by moving the entire Batch process into Azure.</span></span>  <span data-ttu-id="f7a11-113">数据可以在云中向上和向下遍历或保留在本地，而其他数据可以在本地资源不足时在“迸发到云”模型中由计算节点处理。</span><span class="sxs-lookup"><span data-stu-id="f7a11-113">Data can traverse up and down from the cloud or stay on-premises while other data can be processed by compute nodes in a burst-to-cloud model when on-premises resources run low.</span></span>

## <a name="anatomy-of-a-batch-run"></a><span data-ttu-id="f7a11-114">批处理运行剖析</span><span class="sxs-lookup"><span data-stu-id="f7a11-114">Anatomy of a Batch run</span></span>

<span data-ttu-id="f7a11-115">批处理运行中通常至少有两个应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-115">There are typically at least two applications involved in a Batch run.</span></span> <span data-ttu-id="f7a11-116">一个应用程序通常在“头节点”上运行，可将作业提交到池，有时安排计算节点。</span><span class="sxs-lookup"><span data-stu-id="f7a11-116">One application, typically run on a “head node,” submits the job to the pool and sometimes orchestrates the compute nodes.</span></span> <span data-ttu-id="f7a11-117">还可以通过 Azure 门户配置业务流程。</span><span class="sxs-lookup"><span data-stu-id="f7a11-117">The orchestration can also be configured via the Azure portal.</span></span> <span data-ttu-id="f7a11-118">另一个应用程序作为任务由计算节点运行（见图 1）。</span><span class="sxs-lookup"><span data-stu-id="f7a11-118">The other application is run by the compute nodes as a task (see Figure 1).</span></span>

<span data-ttu-id="f7a11-119">计算节点应用程序将执行并行处理风险建模文件的任务。</span><span class="sxs-lookup"><span data-stu-id="f7a11-119">The compute node application performs the task of parallel processing risk modeling files.</span></span> <span data-ttu-id="f7a11-120">可以在计算节点上安装并运行多个应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-120">There can be more than one application installed and run on the compute nodes.</span></span>

<span data-ttu-id="f7a11-121">这些应用程序可以通过 [Batch API](/azure/batch/batch-apis-tools?WT.mc_id=gridbanksg-docs-dastarr)、直接通过 Azure 门户或通过 [Batch 的 Azure CLI 命令](/azure/batch/cli-samples?WT.mc_id=gridbanksg-docs-dastarr)进行上载。</span><span class="sxs-lookup"><span data-stu-id="f7a11-121">These applications can be uploaded via the [Batch API](/azure/batch/batch-apis-tools?WT.mc_id=gridbanksg-docs-dastarr), directly through the Azure Portal, or via the [Azure CLI commands for Batch](/azure/batch/cli-samples?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

![Azure Batch 网格计算](./assets/risk-grid-compute-assets/05-batch-grid-computing.png)

<span data-ttu-id="f7a11-123">**图 1：** Azure Batch 网格计算</span><span class="sxs-lookup"><span data-stu-id="f7a11-123">**Figure 1:** Azure Batch grid computing</span></span>

<span data-ttu-id="f7a11-124">批处理运行由多个逻辑元素组成。</span><span class="sxs-lookup"><span data-stu-id="f7a11-124">A Batch run consists of several logical elements.</span></span> <span data-ttu-id="f7a11-125">图 2 显示了批处理作业的逻辑模型。</span><span class="sxs-lookup"><span data-stu-id="f7a11-125">Figure 2 shows the logical model of a batch job.</span></span> <span data-ttu-id="f7a11-126">池是批处理运行中涉及的 VM 的容器，并预配计算节点 VM。</span><span class="sxs-lookup"><span data-stu-id="f7a11-126">A pool is a container for the VMs involved in the Batch run and provisions the compute node VMs.</span></span> <span data-ttu-id="f7a11-127">池也是计算节点上安装的应用程序的容器。</span><span class="sxs-lookup"><span data-stu-id="f7a11-127">A pool is also the container for the applications installed on the compute nodes.</span></span> <span data-ttu-id="f7a11-128">作业将在池内创建并运行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-128">Jobs are created and run within the pool.</span></span> <span data-ttu-id="f7a11-129">任务将由作业执行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-129">Tasks are executed by the jobs.</span></span> <span data-ttu-id="f7a11-130">任务是运行辅助角色应用程序，并通过命令行指令调用。</span><span class="sxs-lookup"><span data-stu-id="f7a11-130">Tasks are a run of the worker application and are invoked by a command line instruction.</span></span>

<span data-ttu-id="f7a11-131">辅助角色应用程序在创建后将安装到计算节点。</span><span class="sxs-lookup"><span data-stu-id="f7a11-131">The worker application is installed to the compute node when it is created.</span></span>

![池、作业和任务](./assets/risk-grid-compute-assets/06-pool-job-logical-model.png)

<span data-ttu-id="f7a11-133">**图 2：** 逻辑批处理概念模型</span><span class="sxs-lookup"><span data-stu-id="f7a11-133">**Figure 2:** Logical Batch concept model</span></span>

<span data-ttu-id="f7a11-134">执行作业后，池将预配任何所需的辅助角色 VM 并安装辅助角色应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-134">When the job executes, the pool provisions any worker VMs needed and installs the worker applications.</span></span> <span data-ttu-id="f7a11-135">作业将任务分配给这些计算节点，进而运行通常调用已安装应用程序或脚本的命令行指令。</span><span class="sxs-lookup"><span data-stu-id="f7a11-135">The job assigns tasks to those compute nodes, which in turn run a command line instruction which typically calls the installed applications or scripts.</span></span>
<span data-ttu-id="f7a11-136">使用批处理通常遵循原型模式，如下所述：</span><span class="sxs-lookup"><span data-stu-id="f7a11-136">Using Batch typically follows a prototypical pattern, described as follows:</span></span>

1. <span data-ttu-id="f7a11-137">首先，创建一个资源组，使之包含 Batch 资产。</span><span class="sxs-lookup"><span data-stu-id="f7a11-137">Create a resource group to contain the Batch assets.</span></span>
2. <span data-ttu-id="f7a11-138">在该资源组中创建 Batch 帐户。</span><span class="sxs-lookup"><span data-stu-id="f7a11-138">Within the resource group, create a Batch account.</span></span>
3. <span data-ttu-id="f7a11-139">创建链接的存储帐户。</span><span class="sxs-lookup"><span data-stu-id="f7a11-139">Create a linked storage account.</span></span>
4. <span data-ttu-id="f7a11-140">创建在其中预配辅助角色 VM 的池。</span><span class="sxs-lookup"><span data-stu-id="f7a11-140">Create a pool in which to provision the worker VMs.</span></span>
5. <span data-ttu-id="f7a11-141">将计算节点应用程序或脚本上载到该池。</span><span class="sxs-lookup"><span data-stu-id="f7a11-141">Upload the compute node application or scripts to the pool.</span></span>
6. <span data-ttu-id="f7a11-142">创建将任务分配给池中的 VM 的作业。</span><span class="sxs-lookup"><span data-stu-id="f7a11-142">Create a job to assign tasks to the VMs in the pool.</span></span>
7. <span data-ttu-id="f7a11-143">将该作业添加到池中。</span><span class="sxs-lookup"><span data-stu-id="f7a11-143">Add the job to the pool.</span></span>
8. <span data-ttu-id="f7a11-144">开始批处理运行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-144">Begin the Batch run.</span></span>
9. <span data-ttu-id="f7a11-145">该作业会将要在计算节点上运行的任务排入队列。</span><span class="sxs-lookup"><span data-stu-id="f7a11-145">The job queues tasks to run on the compute nodes.</span></span>
10. <span data-ttu-id="f7a11-146">计算节点在 VM 变得可用时运行任务。</span><span class="sxs-lookup"><span data-stu-id="f7a11-146">Compute nodes run the tasks as the VMs become available.</span></span>

<span data-ttu-id="f7a11-147">图 3 显示了此过程的示意图。</span><span class="sxs-lookup"><span data-stu-id="f7a11-147">An illustration of this process is show in Figure 3.</span></span>

![批处理运行过程](./assets/risk-grid-compute-assets/07-batch-run-process.png)

<span data-ttu-id="f7a11-149">**图 3：** 逻辑批处理概念模型</span><span class="sxs-lookup"><span data-stu-id="f7a11-149">**Figure 3:** Logical Batch concept model</span></span>

<span data-ttu-id="f7a11-150">任务完成后，删除计算节点以防在不使用时产生费用。</span><span class="sxs-lookup"><span data-stu-id="f7a11-150">Once tasks are complete, it can be useful to remove the compute nodes to not incur fees while not in use.</span></span> <span data-ttu-id="f7a11-151">若要通过代码或门户删除它们，可以删除包含池，这将删除辅助角色 VM。</span><span class="sxs-lookup"><span data-stu-id="f7a11-151">To delete them, via code or the portal, one can delete the containing pool, which will remove the worker VMs.</span></span>

<span data-ttu-id="f7a11-152">有关如何开始使用 Batch 的更多详细演练，[5 分钟快速入门](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr)（提供多种语言）可指导你完成此过程，或可通过 Azure 门户完成。</span><span class="sxs-lookup"><span data-stu-id="f7a11-152">For more detailed walkthroughs on how to get starting with Batch, [5-minute Quickstarts](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr) are available to take you through the process in several languages or through the Azure portal.</span></span>

## <a name="batch-process-scheduling"></a><span data-ttu-id="f7a11-153">批处理计划</span><span class="sxs-lookup"><span data-stu-id="f7a11-153">Batch process scheduling</span></span>

<span data-ttu-id="f7a11-154">Azure Batch 内置了一个计划程序，因此可以在门户中或通过 API 定义每次运行的计划。</span><span class="sxs-lookup"><span data-stu-id="f7a11-154">Azure Batch has a scheduler built in so scheduling of each run can be defined in the portal or through APIs.</span></span> <span data-ttu-id="f7a11-155">批处理作业计划程序可以定义用来触发多个作业的多个计划。</span><span class="sxs-lookup"><span data-stu-id="f7a11-155">The Batch job scheduler can define multiple schedules to fire multiple jobs.</span></span> <span data-ttu-id="f7a11-156">每个作业都有其自己的属性，如作业开始和结束时所要执行的操作。</span><span class="sxs-lookup"><span data-stu-id="f7a11-156">Each job has its own properties such as what to do when the job starts and ends.</span></span> <span data-ttu-id="f7a11-157">可以定期设置作业计划或一次性运行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-157">Job schedules can be set on recurring intervals or for a one-time run.</span></span>

<span data-ttu-id="f7a11-158">许多银行网格计算系统已经有其自己的计划服务。</span><span class="sxs-lookup"><span data-stu-id="f7a11-158">Many bank grid computing systems already have their own scheduling service.</span></span> <span data-ttu-id="f7a11-159">可能无需立即将我的计划程序移动到 Azure。</span><span class="sxs-lookup"><span data-stu-id="f7a11-159">There may be no immediate need to move my scheduler to Azure.</span></span> <span data-ttu-id="f7a11-160">可以无缝执行此操作，因为 Azure Batch 可以手动调用或通过 SDK 调用，从而允许计划仍在本地和 Azure 中要处理的工作负荷上发生。</span><span class="sxs-lookup"><span data-stu-id="f7a11-160">This can work seamlessly because Azure Batch may be invoked manually or through an SDK, allowing scheduling to still occur on-premises and workloads to be processed in Azure.</span></span>

<span data-ttu-id="f7a11-161">可以按预先确定的计划或按需进行批处理，但在任一情况下无需使未使用的计算节点 VM 保持活动状态。</span><span class="sxs-lookup"><span data-stu-id="f7a11-161">Batch processing can happen on a predetermined schedule or on demand, but in either case there is no need to keep compute node VMs alive when they aren’t being used.</span></span>  <span data-ttu-id="f7a11-162">使用数百个（甚至数千个）VM 计算节点时，可以通过取消预配已完成排队任务的服务器来大幅度节省成本。</span><span class="sxs-lookup"><span data-stu-id="f7a11-162">When using hundreds, if not thousands, of VM compute nodes, significant cost savings can be realized by de-provisioning the servers when they are done running their queued tasks.</span></span>

## <a name="compute-node-applications"></a><span data-ttu-id="f7a11-163">计算节点应用程序</span><span class="sxs-lookup"><span data-stu-id="f7a11-163">Compute node applications</span></span>

<span data-ttu-id="f7a11-164">计算节点需要应用程序在调用任务后运行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-164">Compute nodes need an application to run when a task is invoked.</span></span> <span data-ttu-id="f7a11-165">这些应用程序由公司编写以在将处理作业安装在辅助角色上时执行这些作业。</span><span class="sxs-lookup"><span data-stu-id="f7a11-165">These applications are written by the business to perform the processing jobs when installed on the workers.</span></span> <span data-ttu-id="f7a11-166">在银行业务风险网格计算方案中，此应用程序通常会执行将数据转换为特别适用于下游分析或其他处理的格式的工作。</span><span class="sxs-lookup"><span data-stu-id="f7a11-166">In risk grid computing for banking scenarios this this application often takes on the job of transforming data into formats especially suited for downstream analytics or other processing.</span></span>

<span data-ttu-id="f7a11-167">向池中提供应用程序以分发到计算节点时，会在应用程序包中进行上载。</span><span class="sxs-lookup"><span data-stu-id="f7a11-167">When providing the application to the pool for distribution to compute nodes, it is uploaded in an application package.</span></span> <span data-ttu-id="f7a11-168">应用程序包可能是以前上载的应用程序包的另一个版本。</span><span class="sxs-lookup"><span data-stu-id="f7a11-168">An application package may be another version of a previously uploaded application package.</span></span> <span data-ttu-id="f7a11-169">可以将多个应用程序包安装到一个计算节点。</span><span class="sxs-lookup"><span data-stu-id="f7a11-169">More than one application package can be installed to one compute node.</span></span> <span data-ttu-id="f7a11-170">作业包含要加载到辅助角色计算机上的应用程序包。</span><span class="sxs-lookup"><span data-stu-id="f7a11-170">The job contains the applications packages to load onto the worker machines.</span></span>

<span data-ttu-id="f7a11-171">也可以按版本管理应用程序包部署。</span><span class="sxs-lookup"><span data-stu-id="f7a11-171">Application package deployment may also be managed by version.</span></span> <span data-ttu-id="f7a11-172">如果已将多个版本的应用程序包加载到池中，则可以指定特定版本以用于批处理运行，如图 4 所示。</span><span class="sxs-lookup"><span data-stu-id="f7a11-172">If multiple versions of an application package have been loaded into a pool, a specific version may be designated for use in a Batch run as shown in Figure 4.</span></span> <span data-ttu-id="f7a11-173">这可能在审核环境中或在公司想要重现前一次运行时有必要。</span><span class="sxs-lookup"><span data-stu-id="f7a11-173">This may be necessary in audit environments or when the business wants to reproduce a prior run.</span></span> <span data-ttu-id="f7a11-174">如果辅助角色应用程序中引入了 bug，则还可用于回滚目的。</span><span class="sxs-lookup"><span data-stu-id="f7a11-174">It can also be used for roll-back purposes if a bug is introduced to the worker application.</span></span>

![批处理运行过程](./assets/risk-grid-compute-assets/08-versioning-worker-applications.png)

<span data-ttu-id="f7a11-176">**图 4：** 计算节点任务应用程序版本控制</span><span class="sxs-lookup"><span data-stu-id="f7a11-176">**Figure 4:** Versioning compute node task applications</span></span>

<span data-ttu-id="f7a11-177">应用程序包作为 .zip 文件（其中包含应用程序二进制文件和应用程序运行任务所需的支持文件）上载到池中。</span><span class="sxs-lookup"><span data-stu-id="f7a11-177">An application package is uploaded to the pool as a .zip file containing the application binaries and supporting files required for tasks to run the application.</span></span> <span data-ttu-id="f7a11-178">应用程序包有 2 种范围。</span><span class="sxs-lookup"><span data-stu-id="f7a11-178">There are 2 scopes for application packages.</span></span> <span data-ttu-id="f7a11-179">可以在池的范围或任务的范围内指定应用程序包。</span><span class="sxs-lookup"><span data-stu-id="f7a11-179">You can designate an application package in scope of the pool, or in the scope of tasks.</span></span>

## <a name="pool-application-packages"></a><span data-ttu-id="f7a11-180">池应用程序包</span><span class="sxs-lookup"><span data-stu-id="f7a11-180">Pool application packages</span></span>

<span data-ttu-id="f7a11-181">这些包部署到池中的每个计算节点。</span><span class="sxs-lookup"><span data-stu-id="f7a11-181">These packages are deployed to every compute node in the pool.</span></span> <span data-ttu-id="f7a11-182">计算节点 VM 进行预配、重新启动或重置映像后，如果存在更新的应用程序，则会安装任何池应用程序包的新副本。</span><span class="sxs-lookup"><span data-stu-id="f7a11-182">When a compute node VM is provisioned, rebooted or reimaged, a new copy of any pool application packages is installed, should an updated application exist.</span></span> <span data-ttu-id="f7a11-183">可以将一个或多个应用程序包分配给池，这意味着计算节点将指定所有包。</span><span class="sxs-lookup"><span data-stu-id="f7a11-183">One or more application packages can be assigned to a pool, which means the compute nodes will get all packages designated.</span></span>

## <a name="task-application-packages"></a><span data-ttu-id="f7a11-184">任务应用程序包</span><span class="sxs-lookup"><span data-stu-id="f7a11-184">Task application packages</span></span>

<span data-ttu-id="f7a11-185">针对任务级别的应用程序包仅安装到计划运行任务的计算节点。</span><span class="sxs-lookup"><span data-stu-id="f7a11-185">Application packages targeting the task level are only installed to compute nodes scheduled to run a task.</span></span> <span data-ttu-id="f7a11-186">任务应用程序包适合在一个池中运行多个作业时使用。</span><span class="sxs-lookup"><span data-stu-id="f7a11-186">Task applications packages are intended for use when more than one job is run in one pool.</span></span>

<span data-ttu-id="f7a11-187">任务应用程序在聚合池级作业生成的数据时很有用，风险网格计算方案可能与之密切相关。</span><span class="sxs-lookup"><span data-stu-id="f7a11-187">Task applications are useful when aggregating data produced by pool-level jobs, which can be relevant in risk grid computing scenarios.</span></span> <span data-ttu-id="f7a11-188">例如，任务应用程序可能会运行一组风险计算，此计算可生成稍后要在风险计算工作流中使用的数据。</span><span class="sxs-lookup"><span data-stu-id="f7a11-188">For example, a task application may run a set of risk calculations which generate data to be used later in the risk calculation workflow.</span></span>

## <a name="scaling-batch-jobs"></a><span data-ttu-id="f7a11-189">缩放批处理作业</span><span class="sxs-lookup"><span data-stu-id="f7a11-189">Scaling batch jobs</span></span>

<span data-ttu-id="f7a11-190">未充分利用计算资源时，银行通常会在周末或晚上执行风险分析批处理运行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-190">Banks often perform risk analysis batch runs over weekends or at night when computing resources are underutilized.</span></span> <span data-ttu-id="f7a11-191">虽然此模型适用于一些银行，但它会过快增长而无法满足要求，因此需要更多资金来向网格中添加更多辅助角色计算机。</span><span class="sxs-lookup"><span data-stu-id="f7a11-191">While this model works for some, it can quickly be outgrown, requiring more capital to add more worker machines to the grid.</span></span>

<span data-ttu-id="f7a11-192">如果批处理作业的运行时间太长，或者希望在批处理运行中具有更多计算能力，则 Azure 会提供多个选项。</span><span class="sxs-lookup"><span data-stu-id="f7a11-192">If Batch jobs are taking too long to run or you want more computing power in your Batch runs, Azure offers several options.</span></span>

1. <span data-ttu-id="f7a11-193">分配更多计算节点计算机进行横向扩展。</span><span class="sxs-lookup"><span data-stu-id="f7a11-193">Allocate more compute node machines to scale out.</span></span>
2. <span data-ttu-id="f7a11-194">分配更多功能强大的计算节点计算机进行纵向扩展。</span><span class="sxs-lookup"><span data-stu-id="f7a11-194">Allocate more powerful compute node machines to scale up.</span></span> <span data-ttu-id="f7a11-195">Azure 计算机可能会预配为满足内核和内存，甚至 GPU 计算能力的高性能需求。</span><span class="sxs-lookup"><span data-stu-id="f7a11-195">Azure machines may be provisioned to meet high performance needs of for cores and memory, and even GPU computing power.</span></span>

> <span data-ttu-id="f7a11-196">注意：Microsoft HPC Pack 与 Batch 配合使用是更为复杂的模型，本文未作讨论。</span><span class="sxs-lookup"><span data-stu-id="f7a11-196">Note: Using Microsoft HPC Pack with Batch is a more complex model and is not discussed in this article.</span></span>

<span data-ttu-id="f7a11-197">在批处理群集中，可能只有两个处理 VM 或数千个同时任务正在具有数以万计的内核的数千个 VM 计算节点上运行。</span><span class="sxs-lookup"><span data-stu-id="f7a11-197">In a Batch processing cluster, there may be as few as two processing VMs, or thousands of simultaneous tasks running on thousands of VM compute nodes with tens of thousands of cores.</span></span> <span data-ttu-id="f7a11-198">每个 VM 负责一次运行一个任务。</span><span class="sxs-lookup"><span data-stu-id="f7a11-198">Each VM is responsible for running a single task at a time.</span></span> <span data-ttu-id="f7a11-199">池中的 VM 数可能会按负荷增加或减少时配置的比例手动或自动缩放。</span><span class="sxs-lookup"><span data-stu-id="f7a11-199">The number of VMs in a pool may be scaled manually or automatically as configured when load increases or decreases.</span></span>

### <a name="burst-to-cloud"></a><span data-ttu-id="f7a11-200">迸发到云</span><span class="sxs-lookup"><span data-stu-id="f7a11-200">Burst to cloud</span></span>

<span data-ttu-id="f7a11-201">当本地网格中的计算资源由于执行大型分析作业而不足时，“迸发到云”提供了通过在 Azure 中添加更多计算节点来增强这些资源的方法。</span><span class="sxs-lookup"><span data-stu-id="f7a11-201">When compute resources in an on-premises grid are running low due to executing a large analysis job, “burst to cloud” offers a way to augment those resources by adding more compute nodes in Azure.</span></span> <span data-ttu-id="f7a11-202">迸发到云是当本地资源的需求提高时私有云或基础结构向云服务器分发其工作负荷所采用的模型。</span><span class="sxs-lookup"><span data-stu-id="f7a11-202">Burst to cloud is a model in which private clouds or infrastructure distribute their workload to cloud servers when demand is high for on-premises resources.</span></span>

<span data-ttu-id="f7a11-203">这些计算节点可以预配置为要在 Azure 的 IaaS 平台中预配的 Linux 或 Windows 虚拟机。</span><span class="sxs-lookup"><span data-stu-id="f7a11-203">These compute nodes can be pre-configured as Linux or Windows virtual machines to be provisioned in Azure’s IaaS platform.</span></span> <span data-ttu-id="f7a11-204">此外，服务器还可以预配并自动配置为使用 Tibco Gridserver 和 IBM Symphony 等现有投资。</span><span class="sxs-lookup"><span data-stu-id="f7a11-204">Further, servers can be provisioned and automatically configured to work with existing investments like Tibco Gridserver and IBM Symphony.</span></span>

### <a name="automatic-scaling-formulas"></a><span data-ttu-id="f7a11-205">自动缩放公式</span><span class="sxs-lookup"><span data-stu-id="f7a11-205">Automatic scaling formulas</span></span>

<span data-ttu-id="f7a11-206">可以在 Azure 门户中或通过使用[自动缩放公式](/azure/batch/batch-automatic-scaling?WT.mc_id=gridbanksg-docs-dastarr)配置此弹性。</span><span class="sxs-lookup"><span data-stu-id="f7a11-206">This elasticity can be configured in the Azure portal or by using [automatic scaling formulas](/azure/batch/batch-automatic-scaling?WT.mc_id=gridbanksg-docs-dastarr).</span></span> <span data-ttu-id="f7a11-207">自动缩放公式是上载到批处理计划程序以便对批处理行为进行精细控制的脚本。</span><span class="sxs-lookup"><span data-stu-id="f7a11-207">Automatic scaling formulas are scripts uploaded to the Batch processing scheduler for fine-grained control of Batch behavior.</span></span> <span data-ttu-id="f7a11-208">在计算节点的池上自动缩放通过将节点与自动缩放公式关联来完成。</span><span class="sxs-lookup"><span data-stu-id="f7a11-208">Automatic scaling on a pool of compute nodes is done by associating the nodes with auto-scale formulas.</span></span>

<span data-ttu-id="f7a11-209">下面是自动缩放公式的一个示例，指示自动缩放以一个 VM 开始，并根据需要扩展到 50 个 VM。</span><span class="sxs-lookup"><span data-stu-id="f7a11-209">Below is an example of an automatic scaling formula directing auto scaling to start with one VM and scale up to 50 VMs as needed.</span></span> <span data-ttu-id="f7a11-210">任务完成时，VM 会逐个变为可用状态，自动缩放公式会收缩池。</span><span class="sxs-lookup"><span data-stu-id="f7a11-210">As tasks complete, VMs become free one by one and the auto scaling formula shrinks the pool.</span></span>

```Formula
startingNumberOfVMs = 1;
maxNumberofVMs = 50;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

### <a name="other-scaling-techniques"></a><span data-ttu-id="f7a11-211">其他缩放技术</span><span class="sxs-lookup"><span data-stu-id="f7a11-211">Other scaling techniques</span></span>

<span data-ttu-id="f7a11-212">还可以通过 Enable-AzureBatchAutoScale PowerShell cmdlet 来启用自动缩放。</span><span class="sxs-lookup"><span data-stu-id="f7a11-212">Automatic scaling can also be enabled by the Enable-AzureBatchAutoScale PowerShell cmdlet.</span></span> <span data-ttu-id="f7a11-213">通过 Enable-AzureBatchAutoScale cmdlet 可以自动缩放指定池。</span><span class="sxs-lookup"><span data-stu-id="f7a11-213">The Enable-AzureBatchAutoScale cmdlet enables automatic scaling of the specified pool.</span></span> <span data-ttu-id="f7a11-214">以下是一个示例。</span><span class="sxs-lookup"><span data-stu-id="f7a11-214">An example follows.</span></span>

1. <span data-ttu-id="f7a11-215">第一个命令定义公式，然后将其保存到 `$Formula` 变量。</span><span class="sxs-lookup"><span data-stu-id="f7a11-215">The first command defines a formula, and then saves it to the `$Formula` variable.</span></span>
2. <span data-ttu-id="f7a11-216">第二个命令使用 `RiskGridPool` 中的公式在名为 `$Formula` 的池上启用自动缩放。</span><span class="sxs-lookup"><span data-stu-id="f7a11-216">The second command enables automatic scaling on the pool named `RiskGridPool` using the formula in `$Formula`.</span></span>

```console
C:\> $Formula = ‘startingNumberOfVMs = 1;
maxNumberofVMs = 50;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second?WT.mc_id=gridbanksg-docs-dastarr);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);’;

C:\> Enable-AzureBatchAutoScale -Id "RiskGridPool" -AutoScaleFormula $Formula -BatchContext $Context
```

<span data-ttu-id="f7a11-217">还可以使用 Azure CLI 与 `az batch pool resize` 命令和 Azure 门户完成缩放。</span><span class="sxs-lookup"><span data-stu-id="f7a11-217">Scaling can also be accomplished using the Azure CLI with the `az batch pool resize` command and the Azure Portal.</span></span>

## <a name="data-storage-and-retention"></a><span data-ttu-id="f7a11-218">数据存储和保留</span><span class="sxs-lookup"><span data-stu-id="f7a11-218">Data storage and retention</span></span>

<span data-ttu-id="f7a11-219">数据由计算节点引入并进行处理后，生成的输出数据可能会存储在数据库中以进行进一步处理和分析，或在存储前引入时进行转换来确保下游处理的格式正确。</span><span class="sxs-lookup"><span data-stu-id="f7a11-219">Once data is ingested and processed by a compute node, the resulting output data may be stored in a database for further processing and analysis or transformed upon ingestion before storage to ensure proper formats for downstream processing.</span></span> <span data-ttu-id="f7a11-220">Microsoft Azure 提供了多个存储选项。</span><span class="sxs-lookup"><span data-stu-id="f7a11-220">Microsoft Azure offers several storage options.</span></span> <span data-ttu-id="f7a11-221">[要使用哪个数据存储技术](/azure/architecture/data-guide/?WT.mc_id=gridbanksg-docs-dastarr)的选择很大程度上取决于下游进程中的分析和报告需求。</span><span class="sxs-lookup"><span data-stu-id="f7a11-221">The choice of [which data store technology to use](/azure/architecture/data-guide/?WT.mc_id=gridbanksg-docs-dastarr) depends largely on analysis and or reporting needs in downstream processes.</span></span>

<span data-ttu-id="f7a11-222">使用混合网络时，数据存储目标可能是本地数据存储。</span><span class="sxs-lookup"><span data-stu-id="f7a11-222">When using a hybrid network, the data storage target may be on-premises.</span></span> <span data-ttu-id="f7a11-223">通过混合网络使用 Batch 时，计算节点可以将数据写回到本地数据存储，而无需使用基于 Azure 的存储位置。</span><span class="sxs-lookup"><span data-stu-id="f7a11-223">When using Batch over a hybrid network, compute nodes can write data back to an on-premises data store without using an Azure-based storage location.</span></span> <span data-ttu-id="f7a11-224">辅助角色也可以写入 Azure 文件存储，该文件存储可以在本地计算机上装载为磁盘，以便由使用本地文件的任何进程轻松访问。</span><span class="sxs-lookup"><span data-stu-id="f7a11-224">Workers can also write to Azure File storage, which can be mounted as a disk on an on-premises machine for easy access by any process that works with the files on-premises.</span></span>

## <a name="monitoring-and-logging"></a><span data-ttu-id="f7a11-225">监视和日志记录</span><span class="sxs-lookup"><span data-stu-id="f7a11-225">Monitoring and logging</span></span>

<span data-ttu-id="f7a11-226">若要优化将来的批处理作业运行，应记录数据以帮助标识优化的区域。</span><span class="sxs-lookup"><span data-stu-id="f7a11-226">To optimize future runs of the Batch job, data should be recorded to help identify areas of optimization.</span></span> <span data-ttu-id="f7a11-227">例如，如果辅助角色将要耗尽 CPU 容量，则向计算节点添加内核可帮助避免占用大量 CPU，进而可以更快地完成作业。</span><span class="sxs-lookup"><span data-stu-id="f7a11-227">For example, if workers are running near CPU capacity, adding cores to the compute nodes may help avoid being CPU-bound and the job can finish faster.</span></span> <span data-ttu-id="f7a11-228">批处理作业中的每个应用程序运行都有其自己的特征，并且对批处理运行中的 VM 所做的优化可能会有所不同。</span><span class="sxs-lookup"><span data-stu-id="f7a11-228">Each application run in the Batch job has its own characteristics and the optimizations made to the VMs in the Batch runs may differ.</span></span> <span data-ttu-id="f7a11-229">对于内存密集型任务，可以通过在下次运行时以不同的方式配置计算机来分配更多内存。</span><span class="sxs-lookup"><span data-stu-id="f7a11-229">For memory intensive tasks, more memory can be allocated by configuring the machines differently in the next run.</span></span>

<span data-ttu-id="f7a11-230">可以通过计算节点和网格头应用程序或使用 [Batch 诊断日志记录](/azure/batch/batch-diagnostics?WT.mc_id=gridbanksg-docs-dastarr)通过作业来完成日志记录。</span><span class="sxs-lookup"><span data-stu-id="f7a11-230">Logging can be done by the compute node and grid head applications or by a job using [Batch Diagnostic Logging](/azure/batch/batch-diagnostics?WT.mc_id=gridbanksg-docs-dastarr).</span></span> <span data-ttu-id="f7a11-231">可以配置有关批处理运行性能的日志记录信息，以帮助标识为提高性能和更快地完成任务而需改进的区域。</span><span class="sxs-lookup"><span data-stu-id="f7a11-231">Logging information about the performance of the Batch runs can be configured to help identify which areas to improve for better performance and faster task completion.</span></span>

### <a name="custom-batch-monitoring-and-logging"></a><span data-ttu-id="f7a11-232">自定义 Batch 监视和日志记录</span><span class="sxs-lookup"><span data-stu-id="f7a11-232">Custom Batch monitoring and logging</span></span>

<span data-ttu-id="f7a11-233">控制应用程序和计算节点应用程序可以生成此数据并进行存储以供进一步分析。</span><span class="sxs-lookup"><span data-stu-id="f7a11-233">The controlling application and compute node applications can generate this data and store it for further analysis.</span></span> <span data-ttu-id="f7a11-234">有助于优化批处理作业的数据包括：</span><span class="sxs-lookup"><span data-stu-id="f7a11-234">Data found helpful in optimizing Batch jobs includes:</span></span>

- <span data-ttu-id="f7a11-235">每个任务的开始和结束时间</span><span class="sxs-lookup"><span data-stu-id="f7a11-235">Start and end times for each task</span></span>
- <span data-ttu-id="f7a11-236">每个计算节点处于活动状态且正在运行任务的时间</span><span class="sxs-lookup"><span data-stu-id="f7a11-236">The time each compute node is alive and running tasks</span></span>
- <span data-ttu-id="f7a11-237">每个计算节点处于活动状态且未运行任务的时间</span><span class="sxs-lookup"><span data-stu-id="f7a11-237">The time each compute node is alive and not running tasks</span></span>
- <span data-ttu-id="f7a11-238">批处理作业运行总时间</span><span class="sxs-lookup"><span data-stu-id="f7a11-238">The overall batch job run time</span></span>

### <a name="batch-diagnostic-logging"></a><span data-ttu-id="f7a11-239">Batch 诊断日志记录</span><span class="sxs-lookup"><span data-stu-id="f7a11-239">Batch Diagnostic Logging</span></span>

<span data-ttu-id="f7a11-240">使用控制器和计算节点应用程序发出检测数据存在替代方法。</span><span class="sxs-lookup"><span data-stu-id="f7a11-240">There is an alternative to using the controller and compute node applications to emit instrumentation data.</span></span> <span data-ttu-id="f7a11-241">[Batch 诊断日志记录](/azure/batch/batch-diagnostics?WT.mc_id=gridbanksg-docs-dastarr)可以捕获大量运行数据。</span><span class="sxs-lookup"><span data-stu-id="f7a11-241">[Batch Diagnostics Logging](/azure/batch/batch-diagnostics?WT.mc_id=gridbanksg-docs-dastarr) can capture a lot of the run data.</span></span> <span data-ttu-id="f7a11-242">默认情况下未启用 Batch 诊断日志记录，但必须为 Batch 帐户启用 Batch 诊断日志记录。</span><span class="sxs-lookup"><span data-stu-id="f7a11-242">Batch Diagnostic Logging is not enabled by default and must be enabled for the Batch account.</span></span>

<span data-ttu-id="f7a11-243">Batch 诊断日志记录提供了大量有助于对批处理运行进行故障排除和优化的数据。</span><span class="sxs-lookup"><span data-stu-id="f7a11-243">Batch Diagnostic Logging provides a significant amount of data aiding in trouble shooting and optimizing Batch runs.</span></span> <span data-ttu-id="f7a11-244">作业和任务的开始和结束时间、内核计数、总节点计数和许多其他指标。</span><span class="sxs-lookup"><span data-stu-id="f7a11-244">Start and end times for job and tasks, core count, total node count and many other metrics.</span></span>

<span data-ttu-id="f7a11-245">批处理日志记录需要为发出的日志提供存储目标，并存储批处理所产生的事件，例如创建池、执行作业、执行任务等。除了将诊断日志事件存储在 Azure 存储帐户中外，还可以将 Batch 服务日志事件流式传输到[Azure 事件中心](/azure/event-hubs/event-hubs-what-is-event-hubs?WT.mc_id=gridbanksg-docs-dastarr)，并将其发送到[azure Log Analytics](/azure/log-analytics/log-analytics-overview?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-245">Batch Logging requires a storage destination for the logs emitted, storing events produced by the Batch run such as pool creation, job execution, task execution, etc. In addition to storing diagnostic log events in an Azure Storage account, Batch Service Log events can be streamed to an [Azure Event Hub](/azure/event-hubs/event-hubs-what-is-event-hubs?WT.mc_id=gridbanksg-docs-dastarr), and sent to [Azure Log Analytics](/azure/log-analytics/log-analytics-overview?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

<span data-ttu-id="f7a11-246">使用这些数据，内核计算和头节点应用程序可能会得到优化。</span><span class="sxs-lookup"><span data-stu-id="f7a11-246">Using these data, core computing and head node applications may be optimized.</span></span> <span data-ttu-id="f7a11-247">这样可以降低成本，因为在不再需要辅助角色 VM 时会更快地取消预配这些 VM，而不是等待批处理运行完成。</span><span class="sxs-lookup"><span data-stu-id="f7a11-247">This can lower costs due to things like faster deprovisioning worker VMs when they are no longer needed, rather than waiting for the end of the Batch run to complete.</span></span>

### <a name="batch-management-tools"></a><span data-ttu-id="f7a11-248">Batch 管理工具</span><span class="sxs-lookup"><span data-stu-id="f7a11-248">Batch management tools</span></span>

<span data-ttu-id="f7a11-249">Azure 门户提供了 Batch 监视仪表板，其中显示正在运行作业时的 Batch 相关信息，甚至帐户配额使用情况。</span><span class="sxs-lookup"><span data-stu-id="f7a11-249">The Azure portal provides a Batch monitoring dashboard which shows information about Batch as jobs are running and even account quota usage.</span></span> <span data-ttu-id="f7a11-250">这对于许多批处理作业应用程序已经足够了。</span><span class="sxs-lookup"><span data-stu-id="f7a11-250">It is sufficient for many Batch job applications.</span></span>

<span data-ttu-id="f7a11-251">除了 Azure 门户中提供的 Batch 管理和可视化工具之外，还有一个免费的开放源代码工具 [BatchLabs](https://github.com/Azure/BatchLabs) 用于管理 Batch。</span><span class="sxs-lookup"><span data-stu-id="f7a11-251">In addition to the Batch management and visualization tools available in the Azure portal, there is a free open source tool, [BatchLabs](https://github.com/Azure/BatchLabs) for managing Batch.</span></span> <span data-ttu-id="f7a11-252">这是一个独立客户端工具，可帮助创建、调试和监视 Azure Batch 应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-252">This is a standalone client tool to help create, debug and monitor Azure Batch applications.</span></span> <span data-ttu-id="f7a11-253">下载适用于 Mac、Linux 或 Windows 的安装包。</span><span class="sxs-lookup"><span data-stu-id="f7a11-253">Download an installation package for Mac, Linux, or Windows.</span></span>

## <a name="network-models"></a><span data-ttu-id="f7a11-254">网络模型</span><span class="sxs-lookup"><span data-stu-id="f7a11-254">Network models</span></span>

<span data-ttu-id="f7a11-255">风险分析通常需要将数百个（甚至数千个）文档引入到风险网格计算过程中。</span><span class="sxs-lookup"><span data-stu-id="f7a11-255">Risk analysis often requires hundreds, if not thousands, of documents to be ingested into the risk grid computing process.</span></span> <span data-ttu-id="f7a11-256">这些文件通常位于本地文件存储、网络共享或其他存储库。</span><span class="sxs-lookup"><span data-stu-id="f7a11-256">These files are often located on-premises in a file store, network share, or other repository.</span></span> <span data-ttu-id="f7a11-257">使用基于 Azure 的 VM 访问和处理这些文件时，将本地网络无缝连接到 Azure 网络非常有益，可使文件访问既简单又快速。</span><span class="sxs-lookup"><span data-stu-id="f7a11-257">When using Azure-based VMs to access and process those files, it is often useful for the on-premises network to be seamlessly connected to the Azure network, so file access is simple and fast.</span></span> <span data-ttu-id="f7a11-258">此方法甚至可能意味着在计算节点上进行处理时无需任何代码更改。</span><span class="sxs-lookup"><span data-stu-id="f7a11-258">This approach may even mean no code changes are needed to the code doing the processing on the compute nodes.</span></span>

<span data-ttu-id="f7a11-259">Azure 提供了两种模型，用于安全可靠地将当前本地系统连接到 Azure、[Microsoft Azure ExpressRoute](/azure/expressroute/expressroute-introduction?WT.mc_id=gridbanksg-docs-dastarr) 和 [VPN 网关](/azure/vpn-gateway/?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-259">Azure offers two models for securely and reliably connecting current on-premises systems to Azure, [Microsoft Azure ExpressRoute](/azure/expressroute/expressroute-introduction?WT.mc_id=gridbanksg-docs-dastarr) and [VPN Gateway](/azure/vpn-gateway/?WT.mc_id=gridbanksg-docs-dastarr).</span></span> <span data-ttu-id="f7a11-260">两者都提供安全可靠的连接，尽管在实现、性能、和[其他属性](/azure/networking/networking-overview?WT.mc_id=gridbanksg-docs-dastarr)方面存在差异。</span><span class="sxs-lookup"><span data-stu-id="f7a11-260">Both offer secure reliable connectivity, although there are differences in implementation, performance and [other attributes](/azure/networking/networking-overview?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

<span data-ttu-id="f7a11-261">此外，风险网格计算头节点可能位于本地，并通过 REST API 或 SDK 采用 .NET 和其他语言执行批处理作业。</span><span class="sxs-lookup"><span data-stu-id="f7a11-261">Alternatively, the risk grid computing head node may live on-premises and execute the Batch job through the REST APIs or SDKs in .NET and other languages.</span></span>

<span data-ttu-id="f7a11-262">还有其他方法可用来缩小 Azure 与本地资源之间的差距，而不使用混合网络解决方案。</span><span class="sxs-lookup"><span data-stu-id="f7a11-262">There are other techniques for bridging the gap between Azure and on-premises resources without a hybrid network solution.</span></span> <span data-ttu-id="f7a11-263">下面提供了相关详细信息。</span><span class="sxs-lookup"><span data-stu-id="f7a11-263">More information on this is provided below.</span></span>

### <a name="expressroute"></a><span data-ttu-id="f7a11-264">ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="f7a11-264">ExpressRoute</span></span>

<span data-ttu-id="f7a11-265">ExpressRoute 可通过连接合作伙伴（如当前 Internet 服务提供商 (ISP?WT.mc_id=gridbanksg-docs-dastarr)）提供的专用连接将本地或数据中心网络绑定到 Azure。</span><span class="sxs-lookup"><span data-stu-id="f7a11-265">ExpressRoute ties your on-premises or datacenter network to Azure through a private connection facilitated by a connectivity partner, such as your current Internet Service Provider (ISP?WT.mc_id=gridbanksg-docs-dastarr).</span></span> <span data-ttu-id="f7a11-266">这使两个网络能够将双方视为相同的网络实例，从而在网络之间提供无缝访问。</span><span class="sxs-lookup"><span data-stu-id="f7a11-266">This enables both networks to see each other as the same network instance, providing seamless access between networks.</span></span> <span data-ttu-id="f7a11-267">在你想要将现有本地系统与 Azure 网络集成，并且 ExpressRoute 提供尽可能最快的连接速度时，网络集成十分重要。</span><span class="sxs-lookup"><span data-stu-id="f7a11-267">Network integration is critical when you want to integrate existing on-premises systems with an Azure network, and ExpressRoute offers the fastest connection speeds possible.</span></span>

<span data-ttu-id="f7a11-268">[可在此处找到](https://azure.microsoft.com/pricing/details/expressroute/?WT.mc_id=gridbanksg-docs-dastarr) Azure ExpressRoute 的其他定价信息。</span><span class="sxs-lookup"><span data-stu-id="f7a11-268">Additional pricing information for Azure ExpressRoute [can be found here](https://azure.microsoft.com/pricing/details/expressroute/?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

### <a name="vpn-gateway"></a><span data-ttu-id="f7a11-269">VPN 网关</span><span class="sxs-lookup"><span data-stu-id="f7a11-269">VPN Gateway</span></span>

<span data-ttu-id="f7a11-270">VPN 网关是将网络连接到 Azure 的另一种方法。</span><span class="sxs-lookup"><span data-stu-id="f7a11-270">A VPN Gateway is another way to connect your network to Azure.</span></span> <span data-ttu-id="f7a11-271">此模型的缺点是通过 Internet 传送流量。</span><span class="sxs-lookup"><span data-stu-id="f7a11-271">The downside of this model is traffic flows over the Internet.</span></span> <span data-ttu-id="f7a11-272">因此连接可能会缺少弹性，并且网络速度无法达到 ExpressRoute 的速度，但这可能不是风险网格计算方案的障碍，因为读取数据文件通常是一个快速操作。</span><span class="sxs-lookup"><span data-stu-id="f7a11-272">The connection can less resilient as a result and network speeds cannot reach those of ExpressRoute, however this may not be a barrier for a risk grid computing scenario as reading data files is typically a fast operation.</span></span>

<span data-ttu-id="f7a11-273">[可在此处找到](https://azure.microsoft.com/pricing/details/expressroute/?WT.mc_id=gridbanksg-docs-dastarr) VPN 网关的其他定价信息。</span><span class="sxs-lookup"><span data-stu-id="f7a11-273">Additional pricing information for VPN Gateway [can be found here](https://azure.microsoft.com/pricing/details/expressroute/?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

### <a name="choices-for-connectivity-details"></a><span data-ttu-id="f7a11-274">连接详细信息的选项</span><span class="sxs-lookup"><span data-stu-id="f7a11-274">Choices for connectivity details</span></span>

<span data-ttu-id="f7a11-275">实质上有两个模型用于将网络扩展到 Azure，如图 5 所示。</span><span class="sxs-lookup"><span data-stu-id="f7a11-275">There are essentially two models for extending your network to Azure as shown in Figure 5.</span></span>

1. <span data-ttu-id="f7a11-276">虚拟网关 – 站点到站点</span><span class="sxs-lookup"><span data-stu-id="f7a11-276">Virtual Gateway – Site-to-Site</span></span>
2. <span data-ttu-id="f7a11-277">ExpressRoute – Exchange 或 ISP 提供商</span><span class="sxs-lookup"><span data-stu-id="f7a11-277">ExpressRoute – Exchange or ISP provider</span></span>

![站点到站点和 ExpressRoute](./assets/risk-grid-compute-assets/10-s2s-expressroute.png)

<span data-ttu-id="f7a11-279">**图 5：** 站点到站点和 ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="f7a11-279">**Figure 5:** Site-to-Site and ExpressRoute</span></span>

#### <a name="virtual-gateway-site-to-site-integration"></a><span data-ttu-id="f7a11-280">虚拟网关站点到站点集成</span><span class="sxs-lookup"><span data-stu-id="f7a11-280">Virtual Gateway Site-to-Site integration</span></span>

<span data-ttu-id="f7a11-281">[站点到站点 VPN 网关](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal?WT.mc_id=gridbanksg-docs-dastarr)将本地网络连接到 Azure VNet。</span><span class="sxs-lookup"><span data-stu-id="f7a11-281">A [Site-to-Site VPN Gateway](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal?WT.mc_id=gridbanksg-docs-dastarr) connects your on-premises network to an Azure VNet.</span></span> <span data-ttu-id="f7a11-282">这样可以缩小网络之间的差距，实质上使它们组成同一个网络，从而双向访问资源、服务器和项目。</span><span class="sxs-lookup"><span data-stu-id="f7a11-282">This bridges the gap between networks essentially making them parts of the same network, with two-way access to resources, servers, and artifacts.</span></span> <span data-ttu-id="f7a11-283">这样可以从运行风险网格计算批处理作业的 Azure 辅助角色 VM 直接访问数据文件。</span><span class="sxs-lookup"><span data-stu-id="f7a11-283">This allows direct access to data files from the Azure worker VMs running the risk grid computing batch job.</span></span>

#### <a name="expressroute-integration"></a><span data-ttu-id="f7a11-284">ExpressRoute 集成</span><span class="sxs-lookup"><span data-stu-id="f7a11-284">ExpressRoute integration</span></span>

<span data-ttu-id="f7a11-285">Azure 合作伙伴网络提供商提供的 ExpressRoute 连接实现了与站点到站点连接相同的权益，但速度和可靠性更高。</span><span class="sxs-lookup"><span data-stu-id="f7a11-285">An ExpressRoute connection facilitated by an Azure partner network provider realizes the same benefits as a Site-to-Site connection, but with higher speeds and reliability.</span></span>

<span data-ttu-id="f7a11-286">详细了解 [ExpressRoute 连接模型] （(/azure/expressroute/expressroute-connectivity-models?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-286">Get more information about [ExpressRoute connectivity models] (/azure/expressroute/expressroute-connectivity-models?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

### <a name="batch-processing-without-an-azure-hybrid-network"></a><span data-ttu-id="f7a11-287">在没有 Azure 混合网络的情况下进行批处理</span><span class="sxs-lookup"><span data-stu-id="f7a11-287">Batch processing without an Azure hybrid network</span></span>

<span data-ttu-id="f7a11-288">另一个批处理方案是将所有数据文件上载到 Azure 存储以供基于 Azure 的计算机稍后处理。</span><span class="sxs-lookup"><span data-stu-id="f7a11-288">Another Batch scenario is uploading all data files into Azure storage for later processing by Azure-based compute machines.</span></span> <span data-ttu-id="f7a11-289">文件存储和 Blob 存储可能是存储风险网格计算数据的候选项。</span><span class="sxs-lookup"><span data-stu-id="f7a11-289">File storage and Blob storage are likely candidates for storing risk grid computing data.</span></span>

<span data-ttu-id="f7a11-290">在此方案中，作业控制器和所有计算节点均位于 Azure 中，如图 6 所示。</span><span class="sxs-lookup"><span data-stu-id="f7a11-290">In this scenario, the job controller and all compute nodes live in Azure as shown in Figure 6.</span></span> <span data-ttu-id="f7a11-291">已处理数据的可能目标是 Azure 数据存储，以准备由 Azure 机器学习解决方案或其他系统进行进一步处理。</span><span class="sxs-lookup"><span data-stu-id="f7a11-291">The likely destination for processed data is an Azure data store, in preparation for further processing by Azure Machine Learning solutions or other systems.</span></span> <span data-ttu-id="f7a11-292">此进一步处理超出了本文的范围。</span><span class="sxs-lookup"><span data-stu-id="f7a11-292">This additional processing is beyond the scope of this article.</span></span>

![站点到站点和 ExpressRoute](./assets/risk-grid-compute-assets/09-batch-upload-process.png)

<span data-ttu-id="f7a11-294">**图 6：** 批处理上载到执行的生命周期</span><span class="sxs-lookup"><span data-stu-id="f7a11-294">**Figure 6:** Batch upload to execution lifecycle</span></span>

### <a name="hybrid-network-connectivity-resources"></a><span data-ttu-id="f7a11-295">混合网络连接资源</span><span class="sxs-lookup"><span data-stu-id="f7a11-295">Hybrid network connectivity resources</span></span>

<span data-ttu-id="f7a11-296">可能有多个配置适用于你的情况。</span><span class="sxs-lookup"><span data-stu-id="f7a11-296">Several configurations may be applicable in your situation.</span></span> <span data-ttu-id="f7a11-297">若要帮助制定有关将网络连接到 Azure 的决策和体系结构指南，请参阅模式与实践组提供的 _[将本地网络连接到 Azure](/azure/architecture/reference-architectures/hybrid-networking/?WT.mc_id=gridbanksg-docs-dastarr)_ 一文。</span><span class="sxs-lookup"><span data-stu-id="f7a11-297">To help with decisions and architectural guidance regarding connecting network connectivity to Azure, see the article _[Connect an on-premises network to Azure](/azure/architecture/reference-architectures/hybrid-networking/?WT.mc_id=gridbanksg-docs-dastarr)_ by the patterns & practices group.</span></span>

- <span data-ttu-id="f7a11-298">有关 VPN 网关配置替代方法，[请参阅本文](/azure/vpn-gateway/vpn-gateway-about-vpngateways?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-298">[See this article](/azure/vpn-gateway/vpn-gateway-about-vpngateways?WT.mc_id=gridbanksg-docs-dastarr) for VPN Gateway configuration alternatives.</span></span>
- <span data-ttu-id="f7a11-299">了解 [ExpressRoute 连接模型](/azure/expressroute/expressroute-connectivity-models?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-299">Learn about [ExpressRoute connectivity models](/azure/expressroute/expressroute-connectivity-models?WT.mc_id=gridbanksg-docs-dastarr).</span></span>
- <span data-ttu-id="f7a11-300">计算 [ExpressRoute 定价](https://azure.microsoft.com/pricing/details/expressroute/?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-300">Calculate [ExpressRoute pricing](https://azure.microsoft.com/pricing/details/expressroute/?WT.mc_id=gridbanksg-docs-dastarr).</span></span>
- <span data-ttu-id="f7a11-301">计算 [VPN 网关定价](https://azure.microsoft.com/pricing/details/vpn-gateway/?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-301">Calculate [VPN Gateway pricing](https://azure.microsoft.com/pricing/details/vpn-gateway/?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

## <a name="security-considerations"></a><span data-ttu-id="f7a11-302">安全注意事项</span><span class="sxs-lookup"><span data-stu-id="f7a11-302">Security considerations</span></span>

<span data-ttu-id="f7a11-303">可能会创建 Azure [虚拟网络 (VNet)](/azure/virtual-network/virtual-networks-overview?WT.mc_id=gridbanksg-docs-dastarr) 并在其中创建池的计算节点。</span><span class="sxs-lookup"><span data-stu-id="f7a11-303">An Azure [virtual network (VNet)](/azure/virtual-network/virtual-networks-overview?WT.mc_id=gridbanksg-docs-dastarr) may be created and the pool's compute nodes created within it.</span></span> <span data-ttu-id="f7a11-304">这样会为批处理运行提供额外的隔离级别，并允许使用 [Azure Active Directory (AAD)](/azure/active-directory/active-directory-whatis?WT.mc_id=gridbanksg-docs-dastarr) 进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="f7a11-304">This provides an extra level of isolation for the Batch runs and allows authentication using [Azure Active Directory (AAD)](/azure/active-directory/active-directory-whatis?WT.mc_id=gridbanksg-docs-dastarr).</span></span> <span data-ttu-id="f7a11-305">有关详细信息，请参阅[池网络配置](/azure/batch/batch-api-basics#pool-network-configuration?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-305">See [Pool network configuration](/azure/batch/batch-api-basics#pool-network-configuration?WT.mc_id=gridbanksg-docs-dastarr) for more information.</span></span>

<span data-ttu-id="f7a11-306">使用 AAD 对批处理应用程序进行身份验证有以下两种方法：</span><span class="sxs-lookup"><span data-stu-id="f7a11-306">There are two ways to authenticate a Batch application using AAD:</span></span>

1. <span data-ttu-id="f7a11-307">**集成身份验证**。</span><span class="sxs-lookup"><span data-stu-id="f7a11-307">**Integrated authentication**.</span></span> <span data-ttu-id="f7a11-308">使用 AAD 帐户的批处理应用程序可以使用该帐户获取数据存储的资源和其他资源。</span><span class="sxs-lookup"><span data-stu-id="f7a11-308">A batch application using AAD accounts can use the account to gain resources to data stores and other resources.</span></span>

2. <span data-ttu-id="f7a11-309">**服务主体**。</span><span class="sxs-lookup"><span data-stu-id="f7a11-309">**Service principal**.</span></span> <span data-ttu-id="f7a11-310">AAD 服务主体定义用户和应用程序的访问策略和权限。</span><span class="sxs-lookup"><span data-stu-id="f7a11-310">AAD Service principals define access policy and permissions for users and applications.</span></span> <span data-ttu-id="f7a11-311">服务主体使用绑定到该应用程序的密钥向用户提供身份验证。</span><span class="sxs-lookup"><span data-stu-id="f7a11-311">A service principal provides authentication to users using a secret key tied to that application.</span></span> <span data-ttu-id="f7a11-312">这样可以使用密钥对无人参与应用程序进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="f7a11-312">This allows authenticating an unattended application with a secret key.</span></span> <span data-ttu-id="f7a11-313">服务主体定义应用程序的策略和权限，使其能够在运行时访问资源时代表应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-313">A service principal defines the policy and permissions for an application to represent the application when accessing resources at runtime.</span></span> <span data-ttu-id="f7a11-314">[在此处了解更多信息](/azure/active-directory/develop/active-directory-application-objects?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-314">[Learn more here](/azure/active-directory/develop/active-directory-application-objects?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

<span data-ttu-id="f7a11-315">有关使用 AAD 进行批处理的安全性的详细信息，[请参阅本文](/azure/batch/batch-aad-auth?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-315">For more information on security in batch processing with AAD, [see this article](/azure/batch/batch-aad-auth?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

<span data-ttu-id="f7a11-316">Batch 服务还可以使用共享密钥进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="f7a11-316">The Batch service can also authenticate with a shared key.</span></span> <span data-ttu-id="f7a11-317">身份验证服务需要将两个标头值添加到 HTTP 请求、数据和授权。</span><span class="sxs-lookup"><span data-stu-id="f7a11-317">The authentication service requires two header values to be added to the HTTP request, data and authorization.</span></span> <span data-ttu-id="f7a11-318">有关共享密钥身份验证的详细信息，[请参阅此处](/rest/api/batchservice/authenticate-requests-to-the-azure-batch-service?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-318">[See here for more](/rest/api/batchservice/authenticate-requests-to-the-azure-batch-service?WT.mc_id=gridbanksg-docs-dastarr) on shared key authentication.</span></span>

## <a name="cost-considerations"></a><span data-ttu-id="f7a11-319">成本注意事项</span><span class="sxs-lookup"><span data-stu-id="f7a11-319">Cost considerations</span></span>

<span data-ttu-id="f7a11-320">Azure Batch 可免费使用。</span><span class="sxs-lookup"><span data-stu-id="f7a11-320">There is no charge for using Azure Batch.</span></span> <span data-ttu-id="f7a11-321">仅针对所使用的基础资源（例如虚拟机运行时间、存储和网络）计费。</span><span class="sxs-lookup"><span data-stu-id="f7a11-321">You only pay for the underlying resources consumed, such as virtual machine uptime, storage, and networking.</span></span> <span data-ttu-id="f7a11-322">但是，处于空闲状态的计算节点 VM 仍会产生费用，因此最好在不再需要计算机时对其进行取消预配。</span><span class="sxs-lookup"><span data-stu-id="f7a11-322">However, the compute node VMs still cost money when sitting idle, so it is a good idea to deprovision machines when they are no longer needed.</span></span> <span data-ttu-id="f7a11-323">通常通过删除包含它们的池来完成此操作。</span><span class="sxs-lookup"><span data-stu-id="f7a11-323">This is often done by deleting the pool containing them.</span></span>
>
<span data-ttu-id="f7a11-324">创建池时，可以指定所需的计算节点类型以及每个计算节点的数量。</span><span class="sxs-lookup"><span data-stu-id="f7a11-324">When creating a pool, you can specify which types of compute nodes you want and the number of each.</span></span> <span data-ttu-id="f7a11-325">有以下两种类型的计算节点：</span><span class="sxs-lookup"><span data-stu-id="f7a11-325">The two types of compute nodes are as follows:</span></span>
>
><span data-ttu-id="f7a11-326">**专用计算节点**将为工作负荷保留。</span><span class="sxs-lookup"><span data-stu-id="f7a11-326">**Dedicated compute nodes** are reserved for your workloads.</span></span> <span data-ttu-id="f7a11-327">它们比低优先级节点开销高，但可确保永远不会被抢占。</span><span class="sxs-lookup"><span data-stu-id="f7a11-327">They are more expensive than low-priority nodes, but they are guaranteed to never be preempted.</span></span>
>
><span data-ttu-id="f7a11-328">**低优先级计算节点**利用 Azure 中的多余容量运行 Batch 工作负荷。</span><span class="sxs-lookup"><span data-stu-id="f7a11-328">**Low-priority compute nodes** take advantage of surplus capacity in Azure to run Batch workloads.</span></span> <span data-ttu-id="f7a11-329">低优先级节点每小时的成本比专用节点低，可支持需要大量计算能力的工作负荷。</span><span class="sxs-lookup"><span data-stu-id="f7a11-329">Low-priority nodes are less expensive per hour than dedicated nodes, and enable workloads requiring a lot of compute power.</span></span> <span data-ttu-id="f7a11-330">有关详细信息，请参阅[在 Batch 中使用低优先级 VM](/azure/batch/batch-low-pri-vms?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-330">For more information, see [Use low-priority VMs with Batch](/azure/batch/batch-low-pri-vms?WT.mc_id=gridbanksg-docs-dastarr).</span></span>
>
><span data-ttu-id="f7a11-331">专用和低优先级节点可能位于同一个池中。</span><span class="sxs-lookup"><span data-stu-id="f7a11-331">Dedicated and low-priority nodes may exist in the same pool.</span></span>
>
><span data-ttu-id="f7a11-332">有关低优先级计算节点和专用计算节点的定价信息，请参阅 [Batch 定价](https://azure.microsoft.com/pricing/details/batch/?WT.mc_id=gridbanksg-docs-dastarr)。</span><span class="sxs-lookup"><span data-stu-id="f7a11-332">For pricing information for both low-priority and dedicated compute nodes, see [Batch Pricing](https://azure.microsoft.com/pricing/details/batch/?WT.mc_id=gridbanksg-docs-dastarr).</span></span>

<span data-ttu-id="f7a11-333">使用 Batch 诊断日志记录服务时，发送到 Azure 存储的数据将产生费用。</span><span class="sxs-lookup"><span data-stu-id="f7a11-333">When using the Batch Diagnostic Logging service, the data emitted to Azure storage incurs a cost.</span></span> <span data-ttu-id="f7a11-334">这是与任何其他数据类似的存储数据，定价会受所保留的诊断数据量影响。</span><span class="sxs-lookup"><span data-stu-id="f7a11-334">This is storage data like any other data, and pricing is impacted by the amount of diagnostic data retained.</span></span>

## <a name="getting-started"></a><span data-ttu-id="f7a11-335">入门</span><span class="sxs-lookup"><span data-stu-id="f7a11-335">Getting started</span></span>

<span data-ttu-id="f7a11-336">虽然可以从很多地方开始了解类似于 Batch 风险网格计算的复杂技术，但下面提供了一些逻辑起点可让你更好地了解 Batch 技术。</span><span class="sxs-lookup"><span data-stu-id="f7a11-336">While there are many places to get started with a complex domain like Batch computing for risk grid computing, here are some logical starting points to better understand the Batch technology.</span></span>

<span data-ttu-id="f7a11-337">[建议首先](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr)通过编码和 Azure 门户示例使用 Batch。</span><span class="sxs-lookup"><span data-stu-id="f7a11-337">[This is a great place to start](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr) working with Batch using coding and Azure portal examples.</span></span> <span data-ttu-id="f7a11-338">[在 GitHub 上](https://github.com/Azure/azure-batch-samples)免费提供有 Azure Batch 示例应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-338">The Azure Batch sample applications are also freely available [on GitHub](https://github.com/Azure/azure-batch-samples).</span></span>

<span data-ttu-id="f7a11-339">下面是一些快速教程，可帮助你生成简单的应用程序来创建和运行批处理计算作业。</span><span class="sxs-lookup"><span data-stu-id="f7a11-339">Below are some quick tutorials to help you build a simple application to create and run batch compute jobs.</span></span> <span data-ttu-id="f7a11-340">用于生成应用程序的选项如下：</span><span class="sxs-lookup"><span data-stu-id="f7a11-340">Options for building the application are as follows:</span></span>

- [<span data-ttu-id="f7a11-341">Batch .NET API</span><span class="sxs-lookup"><span data-stu-id="f7a11-341">Batch .NET API</span></span>](/azure/batch/batch-dotnet-get-started?WT.mc_id=gridbanksg-docs-dastarr)
- [<span data-ttu-id="f7a11-342">适用于 Python 的 Batch SDK</span><span class="sxs-lookup"><span data-stu-id="f7a11-342">Batch SDK for Python</span></span>](/azure/batch/batch-python-tutorial?WT.mc_id=gridbanksg-docs-dastarr)
- [<span data-ttu-id="f7a11-343">适用于 Node.js 的 Batch SDK</span><span class="sxs-lookup"><span data-stu-id="f7a11-343">Batch SDK for Node.js</span></span>](/azure/batch/batch-nodejs-get-started?WT.mc_id=gridbanksg-docs-dastarr)
- [<span data-ttu-id="f7a11-344">使用 PowerShell 的 Batch 管理</span><span class="sxs-lookup"><span data-stu-id="f7a11-344">Batch management with PowerShell</span></span>](/azure/batch/batch-powershell-cmdlets-get-started?WT.mc_id=gridbanksg-docs-dastarr)
- [<span data-ttu-id="f7a11-345">使用 Azure CLI 的 Batch 管理</span><span class="sxs-lookup"><span data-stu-id="f7a11-345">Batch management with the Azure CLI</span></span>](/azure/batch/batch-cli-get-started?WT.mc_id=gridbanksg-docs-dastarr)

<span data-ttu-id="f7a11-346">请考虑启动概念证明计划。</span><span class="sxs-lookup"><span data-stu-id="f7a11-346">Consider launching a proof-of-concept initiative.</span></span> <span data-ttu-id="f7a11-347">将数据引入到 Azure 中所用的方法是什么？</span><span class="sxs-lookup"><span data-stu-id="f7a11-347">What will your approach be for data ingestion into Azure?</span></span> <span data-ttu-id="f7a11-348">是否将使用混合网络或通过 SDK 或 REST 接口上载数据？</span><span class="sxs-lookup"><span data-stu-id="f7a11-348">Will you use a hybrid network or upload data via an SDK or REST interface?</span></span> <span data-ttu-id="f7a11-349">如果你考虑使用混合网络，请考虑启动试点将其落实到位。</span><span class="sxs-lookup"><span data-stu-id="f7a11-349">If you are considering a bybrid network, consider launching a pilot to put this in place.</span></span>

<span data-ttu-id="f7a11-350">评估批处理计算作业的大小并选择正确的缩放解决方案。</span><span class="sxs-lookup"><span data-stu-id="f7a11-350">Evaluate the size of your Batch compute jobs and select the right scaling solution.</span></span> <span data-ttu-id="f7a11-351">[自动缩放公式](/azure/batch/batch-automatic-scaling?WT.mc_id=gridbanksg-docs-dastarr)启用复杂的计划方案，而更简单的方案可通过使用 Azure 门户获得。</span><span class="sxs-lookup"><span data-stu-id="f7a11-351">[Autoscaling formulas](/azure/batch/batch-automatic-scaling?WT.mc_id=gridbanksg-docs-dastarr) enable complex scheduling scenarios while simpler scenarios are achivable by using the Azure portal.</span></span>

## <a name="technologies-presented"></a><span data-ttu-id="f7a11-352">所提供的技术</span><span class="sxs-lookup"><span data-stu-id="f7a11-352">Technologies presented</span></span>

<span data-ttu-id="f7a11-353">[Azure Batch](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr) 提供在云中运行大规模并行处理作业的功能。</span><span class="sxs-lookup"><span data-stu-id="f7a11-353">[Azure Batch](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr) provides capabilities to run large scale parallel processing jobs in the cloud.</span></span>

<span data-ttu-id="f7a11-354">[Azure Active Directory](/azure/active-directory/active-directory-whatis?WT.mc_id=gridbanksg-docs-dastarr) 是基于云的多租户目录，也是标识管理服务，可以将核心目录服务、应用程序访问管理和标识保护组合到单个解决方案中。</span><span class="sxs-lookup"><span data-stu-id="f7a11-354">[Azure Active Directory](/azure/active-directory/active-directory-whatis?WT.mc_id=gridbanksg-docs-dastarr) is a multi-tenant, cloud-based directory, and identity management service combining core directory services, application access management, and identity protection into a single solution.</span></span>

<span data-ttu-id="f7a11-355">[自动缩放公式](/azure/batch/batch-automatic-scaling?WT.mc_id=gridbanksg-docs-dastarr)是上载到批处理计划程序以便对批处理缩放行为进行精细控制的脚本。</span><span class="sxs-lookup"><span data-stu-id="f7a11-355">[Automatic scaling formulas](/azure/batch/batch-automatic-scaling?WT.mc_id=gridbanksg-docs-dastarr) are scripts uploaded to the batch processing scheduler for fine grained control of Batch scaling behaviors.</span></span>

<span data-ttu-id="f7a11-356">[Batch 诊断日志记录](/azure/batch/batch-diagnostics?WT.mc_id=gridbanksg-docs-dastarr)是 Azure Batch 支持从批处理运行和生成的事件中创建详细日志的一项功能。</span><span class="sxs-lookup"><span data-stu-id="f7a11-356">[Batch Diagnostics Logging](/azure/batch/batch-diagnostics?WT.mc_id=gridbanksg-docs-dastarr) is a feature of Azure Batch enabling creation of a detailed log from your Batch runs and the events generated.</span></span> <span data-ttu-id="f7a11-357">日志存储在 Azure 存储中。</span><span class="sxs-lookup"><span data-stu-id="f7a11-357">Logs are stored in Azure Storage.</span></span>

<span data-ttu-id="f7a11-358">[BatchLabs](https://github.com/Azure/BatchLabs) 是用于进行适用于 Windows、MacOS 和 Linux 的 Batch 监视和管理的独立应用程序。</span><span class="sxs-lookup"><span data-stu-id="f7a11-358">[BatchLabs](https://github.com/Azure/BatchLabs) is a standalone application for Batch monitoring and management available Windows, MacOS and Linux.</span></span>

<span data-ttu-id="f7a11-359">[ExpressRoute](/azure/expressroute/expressroute-introduction?WT.mc_id=gridbanksg-docs-dastarr) 是用于联接本地和 Azure 网络的高速可靠的混合网络解决方案。</span><span class="sxs-lookup"><span data-stu-id="f7a11-359">[ExpressRoute](/azure/expressroute/expressroute-introduction?WT.mc_id=gridbanksg-docs-dastarr) is a high speed and reliability hybrid network solution for joining on-premises and Azure networks.</span></span>

<span data-ttu-id="f7a11-360">[VPN 网关](/azure/vpn-gateway/?WT.mc_id=gridbanksg-docs-dastarr)是使用 Internet 联接本地和 Azure 网络的混合网络解决方案。</span><span class="sxs-lookup"><span data-stu-id="f7a11-360">[VPN Gateway](/azure/vpn-gateway/?WT.mc_id=gridbanksg-docs-dastarr) is a hybrid network solution using the Internet for joining on-premises and Azure networks.</span></span>

## <a name="conclusion"></a><span data-ttu-id="f7a11-361">结束语</span><span class="sxs-lookup"><span data-stu-id="f7a11-361">Conclusion</span></span>

<span data-ttu-id="f7a11-362">本文档概述了使用 Azure Batch 进行银行业务风险网格计算时的技术解决方案和注意事项。</span><span class="sxs-lookup"><span data-stu-id="f7a11-362">This document provided an overview of technical solutions and considerations when using Azure Batch for risk grid computing for banking.</span></span> <span data-ttu-id="f7a11-363">本文涵盖甚广，从 Azure Batch 定义到[网络选项](/azure/architecture/reference-architectures/hybrid-networking/?WT.mc_id=gridbanksg-docs-dastarr)均包含在内，甚至还包括了成本注意事项。</span><span class="sxs-lookup"><span data-stu-id="f7a11-363">The article covered a lot of ground from the definition of Azure Batch to [networking options](/azure/architecture/reference-architectures/hybrid-networking/?WT.mc_id=gridbanksg-docs-dastarr), and even cost considerations.</span></span>

<span data-ttu-id="f7a11-364">在考虑进一步评估使用 Azure Batch 进行风险网格计算时，[此页面](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr)是一个良好的开端。</span><span class="sxs-lookup"><span data-stu-id="f7a11-364">When considering moving forward in evaluating Azure Batch for risk grid computing, [this page](/azure/batch/?WT.mc_id=gridbanksg-docs-dastarr) is a good resource for getting started.</span></span> <span data-ttu-id="f7a11-365">它提供了风险网格计算中固有的并行文件处理的示例指导教程。</span><span class="sxs-lookup"><span data-stu-id="f7a11-365">It provides sample guided tutorials for parallel file processing, which is inherent in risk grid computing.</span></span> <span data-ttu-id="f7a11-366">这些教程通过 Azure 门户、Azure CLI、.NET 和 Python 提供。</span><span class="sxs-lookup"><span data-stu-id="f7a11-366">Tutorials are provided using the Azure Portal, Azure CLI, .NET and Python.</span></span>
